---
title: "Java ë™ì‹œì„± ì´ìŠˆ: ê°€ì‹œì„±ê³¼ ì›ìžì„± ë¬¸ì œ í•´ê²°í•˜ê¸°"
date: 2025-09-23
categories: [Java, CS]
tags: [Concurrency, Volatile, Synchronized, JMM, Atomicity, Visibility, TIL]
excerpt: "Java ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë°œìƒí•˜ëŠ” ê³ ì§ˆì ì¸ ë¬¸ì œì¸ ê°€ì‹œì„±(Visibility)ê³¼ ì›ìžì„±(Atomicity) ì´ìŠˆì˜ ì›ì¸ì„ Java ë©”ëª¨ë¦¬ ëª¨ë¸(JMM)ì„ í†µí•´ ì´í•´í•˜ê³ , volatileê³¼ synchronized í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•œ í•´ê²° ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤."
author_profile: true
---

# Today I Learned: Java ë™ì‹œì„± ì´ìŠˆ: ê°€ì‹œì„±ê³¼ ì›ìžì„± ë¬¸ì œ í•´ê²°í•˜ê¸°

## ðŸ“š ì˜¤ëŠ˜ í•™ìŠµí•œ ë‚´ìš©

Java ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ëž˜ë°ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìžˆëŠ” ê°•ë ¥í•œ ë„êµ¬ì´ì§€ë§Œ, ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ê³µìœ  ìžì›(Shared Resource)ì— ë™ì‹œì— ì ‘ê·¼í•  ë•Œ ì˜ˆê¸°ì¹˜ ì•Šì€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ê·¸ì¤‘ ê°€ìž¥ ëŒ€í‘œì ì¸ **ê°€ì‹œì„±(Visibility)**ê³¼ **ì›ìžì„±(Atomicity)** ë¬¸ì œì˜ ì›ì¸ê³¼ í•´ê²°ì±…ì— ëŒ€í•´ ê¹Šì´ ìžˆê²Œ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.

---

### 1. **ë¬¸ì œì˜ ê·¼ì›: Java ë©”ëª¨ë¦¬ ëª¨ë¸(JMM)ê³¼ CPU ìºì‹œ**

ì´ ë¬¸ì œë¥¼ ì´í•´í•˜ë ¤ë©´ ë¨¼ì € Java ë©”ëª¨ë¦¬ ëª¨ë¸(JMM)ê³¼ CPUì˜ ë™ìž‘ ë°©ì‹ì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

-   **Main Memory (ë©”ì¸ ë©”ëª¨ë¦¬)**: ëª¨ë“  ìŠ¤ë ˆë“œê°€ ê³µìœ í•˜ëŠ” ë°ì´í„°ê°€ ì €ìž¥ë˜ëŠ” ì£¼ ê¸°ì–µìž¥ì¹˜ìž…ë‹ˆë‹¤.
-   **CPU Cache (CPU ìºì‹œ)**: ê° CPU ì½”ì–´ëŠ” ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ë©”ì¸ ë©”ëª¨ë¦¬ì˜ ë°ì´í„°ë¥¼ ë³µì‚¬í•´ ì™€ì„œ ì‚¬ìš©í•˜ëŠ” ìžì‹ ë§Œì˜ ê³ ì† ìºì‹œ ë©”ëª¨ë¦¬ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

ê° ìŠ¤ë ˆë“œëŠ” ë³„ë„ì˜ CPU ì½”ì–´ì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìžˆìœ¼ë©°, ì´ë•Œ ìŠ¤ë ˆë“œëŠ” ë©”ì¸ ë©”ëª¨ë¦¬ê°€ ì•„ë‹Œ **ìžì‹ ì˜ CPU ìºì‹œì— ì €ìž¥ëœ ê°’ì„ ì‚¬ìš©**í•˜ê²Œ ë©ë‹ˆë‹¤. ë°”ë¡œ ì´ ì§€ì ì—ì„œ ë™ì‹œì„± ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

-   **ê°€ì‹œì„± ë¬¸ì œ**: í•œ ìŠ¤ë ˆë“œê°€ ê³µìœ  ë³€ìˆ˜ì˜ ê°’ì„ ë³€ê²½í•´ë„, ë‹¤ë¥¸ ìŠ¤ë ˆë“œì˜ CPU ìºì‹œì—ëŠ” ì´ì „ ê°’ì´ ê·¸ëŒ€ë¡œ ë‚¨ì•„ ìžˆì–´ ë³€ê²½ëœ ê°’ì„ ì¦‰ì‹œ ë³´ì§€ ëª»í•˜ëŠ” ë¬¸ì œìž…ë‹ˆë‹¤.
-   **ì›ìžì„± ë¬¸ì œ**: `count++`ì™€ ê°™ì´ ë‹¨ì¼ ì—°ì‚°ì²˜ëŸ¼ ë³´ì´ëŠ” ìž‘ì—…ì´ ì‹¤ì œë¡œëŠ” 'ì½ê¸°-ìˆ˜ì •-ì“°ê¸°'ì˜ ì—¬ëŸ¬ ë‹¨ê³„ë¡œ ë‚˜ë‰˜ì–´ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ ë‹¨ê³„ ì‚¬ì´ì— ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ë¼ì–´ë“¤ë©´ ì—°ì‚°ì´ ëˆ„ë½ë˜ì–´ ê°’ì´ ê¼¬ì´ê²Œ ë©ë‹ˆë‹¤.



---

### 2. **ê°€ì‹œì„±(Visibility) ë¬¸ì œì™€ `volatile`**

`volatile` í‚¤ì›Œë“œëŠ” íŠ¹ì • ë³€ìˆ˜ë¥¼ **ë©”ì¸ ë©”ëª¨ë¦¬ì—ì„œ ì§ì ‘ ì½ê³  ì“°ë„ë¡ ê°•ì œ**í•˜ì—¬ ê°€ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.

-   **ë™ìž‘ ì›ë¦¬**:
    1.  **ì“°ê¸°(Write)**: `volatile` ë³€ìˆ˜ì— ê°’ì„ ì“¸ ë•Œ, í•´ë‹¹ ê°’ì€ ì¦‰ì‹œ CPU ìºì‹œë¥¼ ê±°ì³ ë©”ì¸ ë©”ëª¨ë¦¬ì— ë°˜ì˜ë©ë‹ˆë‹¤.
    2.  **ì½ê¸°(Read)**: `volatile` ë³€ìˆ˜ë¥¼ ì½ì„ ë•Œ, CPU ìºì‹œì— ì €ìž¥ëœ ê°’ì´ ìžˆë”ë¼ë„ ë¬´ì‹œí•˜ê³  í•­ìƒ ë©”ì¸ ë©”ëª¨ë¦¬ì—ì„œ ìµœì‹  ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### **`volatile` ì‚¬ìš© ì˜ˆì œ**

ì•„ëž˜ ì½”ë“œëŠ” `running` í”Œëž˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í•œ ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¥¼ ë©ˆì¶”ê²Œ í•˜ëŠ” ì˜ˆì œìž…ë‹ˆë‹¤. `volatile`ì´ ì—†ìœ¼ë©´ `worker` ìŠ¤ë ˆë“œëŠ” `main` ìŠ¤ë ˆë“œê°€ ë³€ê²½í•œ `running` ê°’ì„ ìžì‹ ì˜ ìºì‹œì—ì„œë§Œ ì½ì–´ ë¬´í•œ ë£¨í”„ì— ë¹ ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```java
public class VisibilityExample {
    // volatile í‚¤ì›Œë“œë¡œ ê°€ì‹œì„± ë¬¸ì œ í•´ê²°
    private static volatile boolean running = true;

    public static void main(String[] args) throws InterruptedException {
        // Worker ìŠ¤ë ˆë“œ: runningì´ trueì¸ ë™ì•ˆ ê³„ì† ì‹¤í–‰
        Thread worker = new Thread(() -> {
            while (running) {
                // ... ìž‘ì—… ìˆ˜í–‰ ...
            }
            System.out.println("Worker thread finished.");
        });

        worker.start();

        Thread.sleep(1000); // 1ì´ˆ ëŒ€ê¸°

        System.out.println("Stopping worker thread...");
        running = false; // main ìŠ¤ë ˆë“œê°€ running ê°’ì„ ë³€ê²½
        worker.join();
        System.out.println("Main thread finished.");
    }
}
```

> **í•µì‹¬**: `volatile`ì€ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ ì“°ê³  ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ì½ëŠ” ìƒí™©ì—ì„œ **ê°€ìž¥ ìµœì‹ ì˜ ê°’ì„ ë³´ìž¥**í•˜ëŠ” ë° íš¨ê³¼ì ìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì›ìžì„±ì€ ë³´ìž¥í•˜ì§€ ëª»í•©ë‹ˆë‹¤.

---

### 3. **ì›ìžì„±(Atomicity) ë¬¸ì œì™€ `synchronized`**

`synchronized` í‚¤ì›Œë“œëŠ” **ìž„ê³„ ì˜ì—­(Critical Section)**ì„ ì„¤ì •í•˜ì—¬ ì˜¤ì§ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ í•´ë‹¹ ì½”ë“œ ë¸”ë¡ì´ë‚˜ ë©”ì„œë“œì— ì ‘ê·¼í•˜ë„ë¡ ë³´ìž¥í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì›ìžì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.

-   **ë™ìž‘ ì›ë¦¬**:
    -   `synchronized` ë¸”ë¡ì— ì§„ìž…í•˜ê¸° ì „ì— ìŠ¤ë ˆë“œëŠ” ê°ì²´ì— ëŒ€í•œ **Lock(ë½)**ì„ íšë“í•´ì•¼ í•©ë‹ˆë‹¤.
    -   í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ ë½ì„ íšë“í•˜ë©´, ë‹¤ë¥¸ ìŠ¤ë ˆë“œë“¤ì€ í•´ë‹¹ ë½ì´ í•´ì œë  ë•Œê¹Œì§€ ëŒ€ê¸°(Blocked) ìƒíƒœê°€ ë©ë‹ˆë‹¤.
    -   ë¸”ë¡ ì‹¤í–‰ì´ ëë‚˜ë©´ ìŠ¤ë ˆë“œëŠ” ë½ì„ ìžë™ìœ¼ë¡œ í•´ì œí•©ë‹ˆë‹¤.
    -   `synchronized`ëŠ” ì›ìžì„±ì„ ë³´ìž¥í•  ë¿ë§Œ ì•„ë‹ˆë¼, ë¸”ë¡ì´ ëë‚  ë•Œ ë³€ê²½ëœ ê°’ì„ ë©”ì¸ ë©”ëª¨ë¦¬ì— ë°˜ì˜í•˜ë¯€ë¡œ **ê°€ì‹œì„± ë¬¸ì œë„ í•¨ê»˜ í•´ê²°**í•©ë‹ˆë‹¤.

#### **`synchronized` ì‚¬ìš© ì˜ˆì œ**

ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— `count++`ë¥¼ ì‹¤í–‰í•˜ë©´ ê°’ì´ ëˆ„ë½ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. `synchronized`ë¡œ `increment()` ë©”ì„œë“œë¥¼ ê°ì‹¸ë©´ ì´ ì—°ì‚°ì´ ì›ìžì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ í•­ìƒ ì •í™•í•œ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.

```java
public class AtomicityExample {
    private int count = 0;

    // increment ë©”ì„œë“œ ì „ì²´ë¥¼ ë™ê¸°í™”í•˜ì—¬ ì›ìžì„± ë³´ìž¥
    public synchronized void increment() {
        count++; // ì½ê¸°, ìˆ˜ì •, ì“°ê¸° ìž‘ì—…ì´ í•˜ë‚˜ì˜ ì›ìžì  ë‹¨ìœ„ë¡œ ë¬¶ìž„
    }

    public static void main(String[] args) throws InterruptedException {
        AtomicityExample example = new AtomicityExample();

        Thread t1 = new Thread(() -> {
            for (int i = 0; i < 10000; i++) {
                example.increment();
            }
        });

        Thread t2 = new Thread(() -> {
            for (int i = 0; i < 10000; i++) {
                example.increment();
            }
        });

        t1.start();
        t2.start();

        t1.join();
        t2.join();

        // synchronizedê°€ ì—†ìœ¼ë©´ 20000ë³´ë‹¤ ìž‘ì€ ê°’ì´ ë‚˜ì˜¬ ìˆ˜ ìžˆìŒ
        System.out.println("Final count: " + example.count);
    }
}
```

| êµ¬ë¶„ | **`volatile`** | **`synchronized`** |
| :--- | :--- | :--- |
| **ì£¼ìš” ëª©ì ** | ê°€ì‹œì„±(Visibility) í™•ë³´ | ì›ìžì„±(Atomicity) í™•ë³´ |
| **ë½(Lock)** | ì‚¬ìš©í•˜ì§€ ì•ŠìŒ | ì‚¬ìš©í•¨ (ê°ì²´ ë½) |
| **ì ìš© ëŒ€ìƒ** | ë³€ìˆ˜ | ë©”ì„œë“œ, ì½”ë“œ ë¸”ë¡ |
| **ì„±ëŠ¥** | ìƒëŒ€ì ìœ¼ë¡œ ê°€ë²¼ì›€ | ë½ ê²½ìŸ ì‹œ ì„±ëŠ¥ ì €í•˜ ê°€ëŠ¥ì„± ìžˆìŒ |
| **ë¶€ê°€ íš¨ê³¼** | ì—†ìŒ | ê°€ì‹œì„±ë„ í•¨ê»˜ ë³´ìž¥ |

---

## ðŸ’¡ ë°°ìš´ ì 

1.  **ë™ì‹œì„± ë¬¸ì œëŠ” CPU ìºì‹œì™€ JMMì˜ íŠ¹ì„± ë•Œë¬¸ì— ë°œìƒ**í•˜ëŠ” êµ¬ì¡°ì ì¸ ë¬¸ì œìž…ë‹ˆë‹¤. ë‹¨ìˆœížˆ ì½”ë“œë¥¼ ëˆˆìœ¼ë¡œ ë´ì„œëŠ” ë¬¸ì œë¥¼ ë°œê²¬í•˜ê¸° ì–´ë µë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.
2.  **`volatile`ì€ ê°€ì‹œì„±ë§Œì„ ìœ„í•œ ê²½ëŸ‰ ì†”ë£¨ì…˜**ìž…ë‹ˆë‹¤. ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ í•˜ë‚˜ì˜ ë³€ìˆ˜ë¥¼ ìˆ˜ì •í•˜ëŠ” ë³µí•© ì—°ì‚°(`i++`)ì—ëŠ” ë¶€ì í•©í•˜ë©°, ì˜¤ì§ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ê°’ì„ ì“°ê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œë“¤ì€ ì½ê¸°ë§Œ í•˜ëŠ” 'ìƒíƒœ í”Œëž˜ê·¸' ë“±ì— ì í•©í•©ë‹ˆë‹¤.
3.  **`synchronized`ëŠ” ì›ìžì„±ê³¼ ê°€ì‹œì„±ì„ ëª¨ë‘ ë³´ìž¥í•˜ëŠ” ê°•ë ¥í•œ ë„êµ¬**ìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ ë½ì„ íšë“í•˜ê³  í•´ì œí•˜ëŠ” ê³¼ì •ì—ì„œ ì„±ëŠ¥ ë¹„ìš©ì´ ë°œìƒí•˜ë¯€ë¡œ, ë°˜ë“œì‹œ í•„ìš”í•œ ìµœì†Œí•œì˜ ë²”ìœ„ì—ë§Œ ì ìš©í•´ì•¼ í•œë‹¤ëŠ” ì ì„ ëª…ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤.
