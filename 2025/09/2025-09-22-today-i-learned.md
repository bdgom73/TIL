---
title: "λ„¤νΈμ›ν¬ ν•µμ‹¬ ν”„λ΅ν† μ½: TCP, HTTPS, κ·Έλ¦¬κ³  λ΅λ“ λ°Έλ°μ„"
date: 2025-09-22
categories: [Network, CS]
tags: [TCP, Handshake, HTTPS, TLS, Load Balancer, L4, L7, TIL]
excerpt: "TCPμ 3-way/4-way Handshakeμ™€ Keep-Alive, HTTPSμ SSL/TLS Handshake κ³Όμ •, κ·Έλ¦¬κ³  L4μ™€ L7 λ΅λ“ λ°Έλ°μ„μ λ™μ‘ λ°©μ‹κ³Ό μ°¨μ΄μ μ— λ€ν•΄ κΉμ΄ μκ² ν•™μµν•©λ‹λ‹¤."
author_profile: true
---

# Today I Learned: λ„¤νΈμ›ν¬ ν•µμ‹¬ ν”„λ΅ν† μ½: TCP, HTTPS, κ·Έλ¦¬κ³  λ΅λ“ λ°Έλ°μ„

## π“ μ¤λ ν•™μµν• λ‚΄μ©

μ•μ •μ μ΄κ³  ν™•μ¥μ„± μλ” λ°±μ—”λ“ μ‹μ¤ν…μ„ κµ¬μ¶•ν•κΈ° μ„ν•΄μ„λ” κ·Έ κ·Όκ°„μ΄ λλ” λ„¤νΈμ›ν¬ μ§€μ‹μ΄ ν•„μμ μ…λ‹λ‹¤. μ¤λμ€ λ°μ΄ν„° ν†µμ‹ μ μ‹ λΆ°μ„±μ„ λ³΄μ¥ν•λ” TCP μ—°κ²° κ³Όμ •, μ•μ „ν• ν†µμ‹ μ„ μ„ν• HTTPSμ μ•”νΈν™” λ°©μ‹, κ·Έλ¦¬κ³  νΈλν”½μ„ ν¨μ¨μ μΌλ΅ λ¶„μ‚°μ‹ν‚¤λ” λ΅λ“ λ°Έλ°μ„μ λ™μ‘ μ›λ¦¬μ— λ€ν•΄ ν•™μµν–μµλ‹λ‹¤.

---

### 1. **TCP 3-way/4-way Handshakeμ™€ HTTP Keep-Alive**

TCPλ” μ‹ λΆ°μ„± μλ” λ°μ΄ν„° μ „μ†΅μ„ λ³΄μ¥ν•λ” ν”„λ΅ν† μ½λ΅, ν†µμ‹  μ „μ— λ°λ“μ‹ μ—°κ²°μ„ μλ¦½ν•κ³ (Handshake), ν†µμ‹ μ΄ λλ‚λ©΄ μ—°κ²°μ„ ν•΄μ ν•λ” κ³Όμ •μ„ κ±°μΉ©λ‹λ‹¤.

#### **π¤ 3-way Handshake: μ—°κ²° μλ¦½ κ³Όμ •**

ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ ν†µμ‹ μ„ μ‹μ‘ν•κΈ° μ „μ— μ„λ΅ μ¤€λΉ„κ°€ λμ—λ”μ§€ ν™•μΈν•λ” κ³Όμ •μ…λ‹λ‹¤.

1.  **[SYN] Client β†’ Server**: ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ ‘μ†μ„ μ”μ²­ν•λ” `SYN`(Synchronize) ν¨ν‚·μ„ λ³΄λƒ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” `SYN_SENT` μƒνƒκ°€ λ©λ‹λ‹¤.
2.  **[SYN+ACK] Server β†’ Client**: μ„λ²„λ” μ”μ²­μ„ μλ½ν•λ‹¤λ” μλ―Έλ΅ `SYN` ν¨ν‚·κ³Ό ν•¨κ» μ‘λ‹µ `ACK`(Acknowledgement) ν¨ν‚·μ„ λ³΄λƒ…λ‹λ‹¤. μ„λ²„λ” `SYN_RECEIVED` μƒνƒκ°€ λ©λ‹λ‹¤.
3.  **[ACK] Client β†’ Server**: ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ μ‘λ‹µμ„ μ λ°›μ•λ‹¤λ” `ACK` ν¨ν‚·μ„ λ‹¤μ‹ μ„λ²„λ΅ λ³΄λƒ…λ‹λ‹¤. μ΄ κ³Όμ •μ΄ λλ‚λ©΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ `ESTABLISHED` μƒνƒκ°€ λμ–΄ λ°μ΄ν„° ν†µμ‹ μ„ μ‹μ‘ν•  μ μμµλ‹λ‹¤.



#### **π‘‹ 4-way Handshake: μ—°κ²° ν•΄μ  κ³Όμ •**

μ—°κ²°μ„ μ•μ „ν•κ² μΆ…λ£ν•κΈ° μ„ν•΄ μ–‘λ°©ν–¥ ν†µμ‹ μ„ λ¨λ‘ ν™•μΈν•λ©° ν•΄μ ν•λ” κ³Όμ •μ…λ‹λ‹¤.

1.  **[FIN] Client β†’ Server**: ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°μ„ μΆ…λ£ν•κ² λ‹¤λ” `FIN`(Finish) ν¨ν‚·μ„ λ³΄λƒ…λ‹λ‹¤.
2.  **[ACK] Server β†’ Client**: μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ λ°›μ•λ‹¤λ” `ACK`λ¥Ό λ³΄λƒ…λ‹λ‹¤. μ΄ λ• μ„λ²„λ” μ•„μ§ λ³΄λ‚Ό λ°μ΄ν„°κ°€ λ‚¨μ•„μμ„ μ μμΌλ―€λ΅ μ—°κ²°μ„ λ°”λ΅ λμ§€ μ•κ³  `CLOSE_WAIT` μƒνƒλ΅ λ€κΈ°ν•©λ‹λ‹¤.
3.  **[FIN] Server β†’ Client**: μ„λ²„λ„ λ¨λ“  λ°μ΄ν„° μ „μ†΅μ„ λ§μΉλ©΄, μ—°κ²°μ„ μΆ…λ£ν•κ² λ‹¤λ” `FIN` ν¨ν‚·μ„ ν΄λΌμ΄μ–ΈνΈλ΅ λ³΄λƒ…λ‹λ‹¤.
4.  **[ACK] Client β†’ Server**: ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ μΆ…λ£ μ”μ²­μ„ μ λ°›μ•λ‹¤λ” `ACK`λ¥Ό λ³΄λ‚Έ ν›„, νΉμ‹ λ¨λ¥Ό ν¨ν‚·μ„ κΈ°λ‹¤λ¦¬λ” `TIME_WAIT` μƒνƒλ¥Ό κ±°μ³ μ—°κ²°μ„ μµμΆ… μΆ…λ£ν•©λ‹λ‹¤.

#### **HTTP Keep-Alive**

-   **λ™μ‘ μ›λ¦¬**: HTTP ν†µμ‹ μ€ TCP μ„μ—μ„ μ΄λ£¨μ–΄μ§‘λ‹λ‹¤. `Keep-Alive` μµμ…μ΄ ν™μ„±ν™”λλ©΄, ν• λ² μλ¦½λ TCP μ—°κ²°(3-way handshake)μ„ λ°”λ΅ λμ§€ μ•κ³ , μ •ν•΄μ§„ μ‹κ°„ λ™μ• μ—¬λ¬ HTTP μ”μ²­κ³Ό μ‘λ‹µμ— **μ¬μ‚¬μ©**ν•©λ‹λ‹¤.
-   **μ¥μ **: λ§¤λ² μ”μ²­λ§λ‹¤ Handshake κ³Όμ •μ„ λ°λ³µν•λ” μ¤λ²„ν—¤λ“λ¥Ό μ¤„μ—¬ μ• ν”λ¦¬μΌ€μ΄μ…μ μ‘λ‹µ μ†λ„λ¥Ό ν¬κ² ν–¥μƒμ‹ν‚µλ‹λ‹¤.

---

### 2. **HTTPS λ™μ‘ λ°©μ‹: SSL/TLS ν•Έλ“μ…°μ΄ν¬ κ³Όμ •**

HTTPSλ” HTTP ν†µμ‹ μ„ **SSL/TLS(Secure Sockets Layer/Transport Layer Security)** ν”„λ΅ν† μ½μ„ ν†µν•΄ μ•”νΈν™”ν•λ” λ°©μ‹μ…λ‹λ‹¤. μ΄ κ³Όμ •μ ν•µμ‹¬μ€ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ•μ „ν•κ² μ•”νΈν™” ν‚¤λ¥Ό κµν™ν•λ” **SSL/TLS Handshake**μ…λ‹λ‹¤.

-   **μ•”νΈν™” λ°©μ‹**:
    -   **λΉ„λ€μΉ­ν‚¤ μ•”νΈν™” (Asymmetric Key)**: κ³µκ°ν‚¤(Public Key)μ™€ κ°μΈν‚¤(Private Key) μμ„ μ‚¬μ©ν•©λ‹λ‹¤. κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν• λ°μ΄ν„°λ” κ°μΈν‚¤λ΅λ§ λ³µνΈν™”ν•  μ μμµλ‹λ‹¤. Handshake κ³Όμ •μ—μ„ **λ€μΉ­ν‚¤λ¥Ό μ•μ „ν•κ² κµν™**ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.
    -   **λ€μΉ­ν‚¤ μ•”νΈν™” (Symmetric Key)**: μ•”νΈν™”μ™€ λ³µνΈν™”μ— λ™μΌν• ν‚¤(μ„Έμ… ν‚¤)λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. λΉ„λ€μΉ­ν‚¤ λ°©μ‹λ³΄λ‹¤ ν›¨μ”¬ λΉ λ¥΄κΈ° λ•λ¬Έμ—, Handshakeκ°€ λλ‚ ν›„ **μ‹¤μ  λ°μ΄ν„°λ¥Ό μ•”νΈν™”**ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.

#### **SSL/TLS Handshake μƒμ„Έ κ³Όμ •**

1.  **[Client Hello] Client β†’ Server**: ν΄λΌμ΄μ–ΈνΈκ°€ μ§€μ›ν•λ” TLS λ²„μ „, μ•”νΈν™” λ°©μ‹(Cipher Suites), λλ¤ λ°μ΄ν„° λ“±μ„ μ„λ²„μ— μ „μ†΅ν•©λ‹λ‹¤.
2.  **[Server Hello] Server β†’ Client**: μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ μ•”νΈν™” λ°©μ‹ μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•κ³ , μ„λ²„μ SSL μΈμ¦μ„(μ„λ²„μ κ³µκ°ν‚¤ ν¬ν•¨), κ·Έλ¦¬κ³  μ„λ²„κ°€ μƒμ„±ν• λλ¤ λ°μ΄ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.
3.  **[Certificate Verification & Key Exchange] Client**:
    -   ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„λ΅λ¶€ν„° λ°›μ€ μΈμ¦μ„κ°€ μ‹ λΆ°ν•  μ μλ” CA(Certificate Authority)μ— μν•΄ μ„λ…λμ—λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.
    -   κ²€μ¦μ΄ μ™„λ£λλ©΄, ν΄λΌμ΄μ–ΈνΈλ” **λ€μΉ­ν‚¤λ΅ μ‚¬μ©ν•  ν‚¤(Pre-Master Secret)**λ¥Ό μƒμ„±ν•μ—¬ **μ„λ²„μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”**ν• λ’¤ μ„λ²„μ— μ „μ†΅ν•©λ‹λ‹¤.
4.  **[Decryption & Session Key Creation] Server**:
    -   μ„λ²„λ” μμ‹ μ **κ°μΈν‚¤**λ΅ ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν•μ—¬ Pre-Master Secretμ„ μ–»μµλ‹λ‹¤.
    -   μ΄μ  ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μΌλ ¨μ λλ¤ λ°μ΄ν„°μ™€ Pre-Master Secretμ„ μ΅°ν•©ν•μ—¬, μ‹¤μ  λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κ³  λ³µνΈν™”ν•  **λ€μΉ­ν‚¤(μ„Έμ… ν‚¤)**λ¥Ό κ°κ° μƒμ„±ν•©λ‹λ‹¤.
5.  **[Finished] Client β†” Server**: μ–‘μΈ΅μ€ μƒμ„±λ λ€μΉ­ν‚¤λ¥Ό μ΄μ©ν•΄ Handshake κ³Όμ •μ„ μ™„λ£ν–λ‹¤λ” μ•”νΈν™”λ λ©”μ‹μ§€λ¥Ό μ„λ΅ κµν™ν•©λ‹λ‹¤. μ΄ κ³Όμ •μ΄ λλ‚λ©΄ λ¨λ“  HTTP μ”μ²­/μ‘λ‹µμ€ μ΄ **λ€μΉ­ν‚¤**λ΅ μ•”νΈν™”λμ–΄ μ „μ†΅λ©λ‹λ‹¤.



---

### 3. **λ΅λ“ λ°Έλ°μ„ (L4 vs L7) μΆ…λ¥μ™€ λ™μ‘ λ°©μ‹ λΉ„κµ λ¶„μ„**

**λ΅λ“ λ°Έλ°μ„**λ” μ—¬λ¬ λ€μ μ„λ²„μ— νΈλν”½μ„ ν¨μ¨μ μΌλ΅ λ¶„μ‚°μ‹μΌ κ°€μ©μ„±κ³Ό ν™•μ¥μ„±μ„ λ†’μ΄λ” μ¥λΉ„μ…λ‹λ‹¤. λ™μ‘ν•λ” OSI κ³„μΈµμ— λ”°λΌ L4μ™€ L7 λ΅λ“ λ°Έλ°μ„λ΅ λ‚λ‰©λ‹λ‹¤.

#### **L4 λ΅λ“ λ°Έλ°μ„ (Transport Layer)**

-   **λ™μ‘ λ°©μ‹**: OSI 4κ³„μΈµμΈ **μ „μ†΅ κ³„μΈµ**μ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ νΈλν”½μ„ λ¶„μ‚°ν•©λ‹λ‹¤. μ£Όλ΅ **IP μ£Όμ†μ™€ ν¬νΈ λ²νΈ**λ¥Ό λ³΄κ³  μ–΄λ–¤ μ„λ²„λ΅ μ”μ²­μ„ λ³΄λ‚Όμ§€ κ²°μ •ν•©λ‹λ‹¤.
-   **νΉμ§•**:
    -   **κ³ μ† μ²λ¦¬**: ν¨ν‚·μ λ‚΄μ©μ„ λ³΄μ§€ μ•κ³  IPμ™€ ν¬νΈ μ •λ³΄λ§ ν™•μΈν•λ―€λ΅ μ²λ¦¬ μ†λ„κ°€ λ§¤μ° λΉ λ¦…λ‹λ‹¤.
    -   **λ‹¨μν• λ¶„μ‚°**: λΌμ΄λ“ λ΅λΉ, μµμ† μ—°κ²° λ°©μ‹ λ“± λ‹¨μν• μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•©λ‹λ‹¤.
    -   **μ μ—°μ„± λ¶€μ΅±**: HTTP ν—¤λ”λ‚ URL κ°™μ€ μ• ν”λ¦¬μΌ€μ΄μ… λ λ²¨μ μ •λ³΄λ¥Ό λ¶„μ„ν•  μ μ—†μ–΄, νΉμ • URLμ— λ”°λΌ λ‹¤λ¥Έ μ„λ²„λ΅ λ³΄λ‚΄λ” λ“±μ μ„Έλ°€ν• μ μ–΄κ°€ λ¶κ°€λ¥ν•©λ‹λ‹¤.

#### **L7 λ΅λ“ λ°Έλ°μ„ (Application Layer)**

-   **λ™μ‘ λ°©μ‹**: OSI 7κ³„μΈµμΈ **μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ**μ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ νΈλν”½μ„ λ¶„μ‚°ν•©λ‹λ‹¤. **HTTP/HTTPS ν—¤λ”, URL κ²½λ΅, μΏ ν‚¤, μ”μ²­ λ©”μ„λ“** λ“± κµ¬μ²΄μ μΈ λ‚΄μ©μ„ λ¶„μ„ν•μ—¬ λΌμ°ν… κ²°μ •μ„ λ‚΄λ¦½λ‹λ‹¤.
-   **νΉμ§•**:
    -   **μ§€λ¥μ μΈ λ¶„μ‚°**: `/api/images/` κ²½λ΅λ” μ΄λ―Έμ§€ μ„λ²„λ΅, `/api/videos/` κ²½λ΅λ” λΉ„λ””μ¤ μ„λ²„λ΅ λ³΄λ‚΄λ” λ“± **μ½ν…μΈ  κΈ°λ° λΌμ°ν…**μ΄ κ°€λ¥ν•©λ‹λ‹¤.
    -   **λ‹¤μ–‘ν• κΈ°λ¥**: SSL Offloading(μ•”λ³µνΈν™” μ²λ¦¬), μΊμ‹±, λ³΄μ•(WAF) λ“± λ‹¤μ–‘ν• λ¶€κ°€ κΈ°λ¥μ„ μν–‰ν•  μ μμµλ‹λ‹¤.
    -   **μ„±λ¥ λ¶€ν•**: ν¨ν‚·μ λ‚΄μ©μ„ λ¨λ‘ λ¶„μ„ν•΄μ•Ό ν•λ―€λ΅ L4μ— λΉ„ν•΄ μ²λ¦¬ μ†λ„κ°€ λλ¦¬κ³  λ¦¬μ†μ¤ μ†λ¨κ°€ ν½λ‹λ‹¤.

| κµ¬λ¶„ | **L4 λ΅λ“ λ°Έλ°μ„** | **L7 λ΅λ“ λ°Έλ°μ„** |
| :--- | :--- | :--- |
| **λ™μ‘ κ³„μΈµ** | Transport Layer (OSI 4κ³„μΈµ) | Application Layer (OSI 7κ³„μΈµ) |
| **λ¶„μ‚° κΈ°μ¤€** | IP, Port | URL, HTTP Header, Cookie λ“± |
| **μ²λ¦¬ μ†λ„** | λ§¤μ° λΉ λ¦„ | μƒλ€μ μΌλ΅ λλ¦Ό |
| **λΌμ°ν…** | λ‹¨μ, μ €μμ¤€ λΌμ°ν… | μ§€λ¥μ , κ³ μμ¤€ λΌμ°ν… |
| **μ£Όμ” κΈ°λ¥** | νΈλν”½ λ¶„μ‚° (TCP/UDP) | μ½ν…μΈ  κΈ°λ° μ¤μ„μΉ­, SSL Offloading, WAF |
| **λ€ν‘ μ¥λΉ„** | LVS, NLB (AWS) | Nginx, HAProxy, ALB (AWS) |

---

## π’΅ λ°°μ΄ μ 

1.  **μ‹ λΆ°μ„±κ³Ό ν¨μ¨μ„±μ νΈλ μ΄λ“μ¤ν”„**: TCP Handshakeλ” μ‹ λΆ°μ„±μ„ λ³΄μ¥ν•μ§€λ§ μ¤λ²„ν—¤λ“κ°€ ν¬λ©°, `Keep-Alive`λ” μ΄ μ¤λ²„ν—¤λ“λ¥Ό μ¤„μ—¬ ν¨μ¨μ„±μ„ λ†’μ΄λ” μ¤‘μ”ν• μµμ ν™” κΈ°λ²•μ„μ„ μ΄ν•΄ν–μµλ‹λ‹¤.
2.  **λ³΄μ• ν†µμ‹ μ ν•µμ‹¬ μ›λ¦¬**: HTTPSλ” μ†λ„κ°€ λΉ λ¥Έ λ€μΉ­ν‚¤μ™€ ν‚¤ κµν™μ΄ μ•μ „ν• λΉ„λ€μΉ­ν‚¤μ μ¥μ μ„ μ΅°ν•©ν• ν•μ΄λΈλ¦¬λ“ λ°©μ‹μ΄λΌλ” κ²ƒμ„ λ…ν™•ν μ•κ² λμ—μµλ‹λ‹¤. SSL μΈμ¦μ„μ μ—­ν• μ€ μ„λ²„μ μ‹ μ›μ„ λ³΄μ¦ν•κ³  κ³µκ°ν‚¤λ¥Ό μ•μ „ν•κ² μ „λ‹¬ν•λ” κ²ƒμ…λ‹λ‹¤.
3.  **μƒν™©μ— λ§λ” λ΅λ“ λ°Έλ°μ‹± μ „λµ**: λ‹¨μν•κ³  λΉ λ¥Έ νΈλν”½ λ¶„μ‚°μ΄ ν•„μ”ν•  λ•λ” L4λ¥Ό, νΉμ • μ½ν…μΈ λ‚ ν΄λΌμ΄μ–ΈνΈ μƒνƒμ— λ”°λΌ μ •κµν• μ μ–΄κ°€ ν•„μ”ν•  λ•λ” L7μ„ μ„ νƒν•΄μ•Ό ν•λ©°, ν„λ€ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ… μ•„ν‚¤ν…μ²μ—μ„λ” L7μ μ—­ν• μ΄ λ”μ± μ¤‘μ”ν•΄μ§€κ³  μμμ„ κΉ¨λ‹¬μ•μµλ‹λ‹¤.

---

## π”— μ°Έκ³  μλ£

-   [TCP 3-Way Handshake (GeeksforGeeks)](https://www.geeksforgeeks.org/tcp-3-way-handshake-process/)
-   [How HTTPS Works (SSL.com)](https://www.ssl.com/article/how-https-works/)
-   [What is a Load Balancer? L4 vs L7 (NGINX)](https://www.nginx.com/resources/glossary/load-balancing/)