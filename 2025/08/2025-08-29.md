# 2025.08.29 TIL

---

### 1. Vercel 배포 이슈 처리


```text
Error: A Serverless Function has exceeded the unzipped maximum size of 250 MB. : https://vercel.link/serverless-function-size
```
현재 vercel 에서는 다음과 같이 안내하고 있습니다.

`
Vercel Functions의 경우, 압축 해제된 최대 크기는 250MB (압축 시 약 50MB)입니다. Vercel에서 애플리케이션을 빌드하고 서버리스 함수(코드 및 종속성)를 패키징한 후, 압축 해제된 번들 크기는 250MB를 초과할 수 없습니다. 이 제한은 설정할 수 없습니다.
`

배포 로그를 확인해 본 결과 아래와 같이 캐싱된 데이터가 포함되며 용량이 초과하게 된 걸 확인했습니다.
```text
Large Dependencies           Uncompressed size
.next/cache/webpack                  412.14 MB
...
```

#### ✅ 해결
초과된 데이터가 캐싱관련 데이터였으므로 아래와 같은 방법으로 이 문제를 해결해 보았습니다. 

현재 Next.js 15 + src/app 구조를 기준입니다.

1. 불필요한 파일 제외 해보기

`Vercel을 사용하면 설정을 통해 Serverless Functions에서 파일을 명시적으로 포함하거나 제외할 수 있습니다`
라는 안내에 따라 다음과 같이 설정해주섰습니다.

`vercel.json` 을 루트 프로젝트 생성하고 다음과 같은 내용을 추가하였습니다.
```json
{
  "functions": {
    "src/app/api/**": {
      "excludeFiles": "{.next/cache,node_modules/.cache,tests,docs,scripts,tmp}/**"
    }
  }
}
```

2. 빌드 캐시 및 .git 디렉토리 제외

next.config.js/ts 에서 `outputFileTracingExcludes` 를 추가하여
루트에 다음과 같이 설정합니다.

```aiignore
const nextConfig: NextConfig = {
  outputFileTracingExcludes : {
    '/': ['.git', '.next/cache', 'node_modules/.cache']
  },
  ...
}
```


